<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="theme-color" content="#ebc9eb">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CSS Custom Properties and a new look | kevingimbel.de &mdash; Web Development, DevOps, Baking, and everything else.</title>
<link rel="icon" href="/assets/img/kevin-avatar.jpg">
<link rel="stylesheet" href="/assets/css/styles.css">
  
  
  

</head>
<body class="ddark-mode">
  <header class="site-header">
  <div class="header-logo__wrap">
      <a href="/" title="KevinGimbel.de" class="flex">
        <svg width="50" height="50" viewBox="0 0 100 100" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">
    <g transform="matrix(1.56696,0,0,1.56696,-27.7261,-25.8245)">
        <path id="side__top__8" d="M62.621,47.565L22.159,31.27C27.831,27.341 60.086,17.037 64.204,17.959L62.621,47.565Z" style="fill:var(--logo-dice-fill-color, #000);fill-opacity:0.5;stroke:black;stroke-width:0.64px;"/>
        <path id="side__right__5" d="M64.221,17.99L62.867,47.364L76.028,61.239C72.854,46.851 69.214,31.901 64.221,17.99Z" style="fill:var(--logo-dice-fill-color, #000);fill-opacity:0.75;stroke:black;stroke-width:0.64px;"/>
        <path id="side__bottom__2" d="M76.012,61.253L62.755,47.623L36.622,79.172C41.177,78.93 61.738,70.763 76.012,61.253Z" style="fill:var(--logo-dice-fill-color, #000);stroke:black;stroke-width:0.64px;"/>
        <path id="side__left__3" d="M36.499,79.142C31.205,62.65 24.166,44.211 22.177,31.336L62.552,47.662L36.499,79.142Z" style="fill:var(--logo-dice-fill-color, #000);fill-opacity:0.75;stroke:black;stroke-width:0.64px;"/>
    </g>
</svg>
        <svg width="100%" height="100%" viewBox="0 0 230 100" style="fill:var(--logo-writing-fill-color, #000);fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M18.373,49.855c-0.321,0.402 -0.64,0.809 -0.956,1.221c-2.191,2.86 -7.191,12.813 -9.559,16.829c-0.564,0.957 -1.02,1.611 -1.273,1.862c-0.813,0.804 -1.554,0.389 -1.878,0.07c-0.157,-0.156 -0.403,-0.489 -0.383,-1.075c0.011,-0.315 0.144,-0.965 0.391,-1.843c1.021,-3.627 4.018,-11.891 5.312,-15.193c2.479,-6.33 4.969,-12.646 7.405,-18.985c1.621,-4.219 3.218,-8.449 4.775,-12.698c0.944,-2.578 1.627,-6.692 1.357,-10.323c-0.173,-2.329 -2.323,-3.182 -3.639,-4.372c-0.71,-0.653 -0.756,-1.759 -0.103,-2.469c0.653,-0.71 1.56,-0.534 2.469,-0.103c2.282,1.084 4.445,3.401 4.636,6.723c0.236,4.116 -0.623,8.761 -1.74,11.662c-1.63,4.239 -3.3,8.457 -4.992,12.667c-2.535,6.306 -5.117,12.591 -7.692,18.889c-0.62,1.517 -1.626,4.104 -2.627,6.79c2.197,-3.943 4.527,-8.066 5.847,-9.746c0.665,-0.847 1.339,-1.673 2.022,-2.482c-0.181,-1.773 0.068,-3.714 0.635,-5.73c2.788,-9.924 13.284,-21.739 13.888,-22.522c1.564,-2.032 7.009,-8.009 9.454,-10.271c0.638,-0.591 1.132,-0.944 1.353,-1.028c0.355,-0.136 0.622,-0.054 0.79,0.034c0.255,0.135 0.477,0.37 0.478,0.807c0.005,1.756 -0.409,3.551 -1.021,5.321c-0.865,2.501 -2.128,4.952 -3.085,7.161c-1.6,3.694 -3.565,6.932 -5.743,9.934c-4.473,6.163 -9.871,11.309 -14.894,17.362c0.338,1.239 0.993,2.347 2.048,3.268c5.538,4.83 11.885,7.173 18.576,7.864c6.354,0.656 13.014,-0.172 19.599,-1.769c-0.521,-0.512 -0.977,-1.036 -1.356,-1.561c-0.934,-1.292 -1.901,-2.782 -2.686,-4.334c-0.54,-1.067 -0.995,-2.163 -1.3,-3.245c-0.343,-1.218 -0.75,-3.845 -0.752,-6.218c-0.001,-1.851 0.283,-3.549 0.899,-4.471c2.137,-3.2 5.903,-3.57 9.722,-2.26c4.992,1.712 9.961,6.289 10.819,9.883c0.738,3.087 -0.646,5.833 -3.001,8.059c-2.189,2.069 -5.216,3.684 -7.861,4.721c1.338,0.811 2.84,1.489 4.379,1.938c3.258,0.951 6.718,0.898 9.017,-1.428c1.233,-1.247 1.789,-2.847 2.069,-4.55c0.474,-2.875 0.181,-6.039 0.421,-8.653c0.001,-0.016 -0.025,-1.197 0.146,-2.265c0.128,-0.795 0.391,-1.525 0.732,-1.957c0.586,-0.742 1.361,-1.032 2.391,-0.522c0.637,0.315 1.252,0.888 1.806,1.608c0.929,1.207 1.707,2.864 2.296,3.788c2.514,3.945 4.201,8.165 6.396,12.142c0.898,1.627 1.884,3.213 3.061,4.716c0.789,1.008 1.586,2.601 2.604,3.842c0.336,0.409 0.691,0.785 1.1,1.032c0.232,-0.803 0.734,-2.528 0.801,-2.715c0.73,-2.04 1.426,-4.119 2.176,-6.172c0.51,-1.395 1.045,-2.779 1.631,-4.131c2.464,-5.679 5.578,-11.192 9.942,-15.324c2.975,-2.816 6.528,-4.996 10.842,-6.18c0.943,-0.258 1.624,-0.036 2.123,0.341c0.459,0.347 0.814,0.911 0.944,1.697c0.158,0.951 -0.058,2.44 -0.401,3.854c-0.327,1.347 -0.769,2.607 -0.796,2.929c-0.216,2.579 -1.25,9.062 -0.579,14.218c0.201,1.545 0.551,2.963 1.174,4.066c0.572,1.015 1.396,1.724 2.617,1.852c2.603,0.272 3.684,-1.505 4.272,-3.745c0.704,-2.681 0.731,-6.011 0.905,-8.688c0.115,-1.772 0.309,-3.295 0.691,-4.298c0.188,-0.495 0.469,-0.759 0.695,-0.916c0.401,-0.279 0.827,-0.36 1.275,-0.286c0.345,0.058 0.919,0.295 1.38,1.007c0.336,0.519 0.81,1.667 1.48,2.609c0.165,0.23 0.341,0.447 0.541,0.616c0.112,0.095 0.221,0.202 0.37,0.177c1.304,-0.22 2.171,-1.569 2.962,-2.92c1.2,-2.045 2.091,-4.298 2.832,-5.221c0.593,-0.738 1.262,-1.002 1.81,-1.023c0.639,-0.025 1.418,0.198 2.036,1.245c0.36,0.612 0.761,1.806 1.142,3.81l0.896,4.465c0.848,3.456 1.914,5.035 3.576,5.229c1.227,0.144 2.592,-0.394 4.059,-1.131c2.131,-1.071 4.403,-2.625 6.665,-3.958c4.463,-2.632 9.162,-4.976 14.093,-6.44c3.363,-0.999 6.835,-1.588 10.414,-1.592c1.867,-0.002 3.595,0.631 5.24,1.613c2.95,1.762 5.586,4.813 8.587,6.084c0.997,0.422 2.048,0.827 3.125,1.153c1.022,0.31 2.066,0.547 3.105,0.65c0.692,0.068 2.262,0.044 3.06,0.019c0.108,-0.021 0.221,-0.032 0.336,-0.032c14.441,0.016 10.283,3.064 0.153,3.51c-0.655,0.029 -2.966,0.065 -3.895,-0.029c-1.016,-0.102 -2.037,-0.307 -3.043,-0.58c-1.448,-0.394 -2.868,-0.931 -4.197,-1.497c-3.134,-1.336 -5.923,-4.473 -9.002,-6.322c-1.093,-0.656 -2.226,-1.132 -3.469,-1.134c-4.069,-0.004 -7.985,0.837 -11.75,2.181c-3.835,1.369 -7.515,3.258 -11.044,5.328c-2.793,1.638 -5.61,3.581 -8.166,4.647c-1.66,0.692 -3.238,1.027 -4.664,0.857c-2.642,-0.316 -5.082,-2.268 -6.415,-7.768l-0.922,-4.638c-0.052,-0.278 -0.102,-0.536 -0.152,-0.774c-0.763,1.545 -1.693,3.457 -2.869,4.91c-1.104,1.363 -2.434,2.332 -3.964,2.586c-1.424,0.236 -2.659,-0.4 -3.632,-1.519c-0.042,-0.047 -0.083,-0.097 -0.125,-0.149c-0.035,0.599 -0.065,1.232 -0.102,1.881c-0.186,3.291 -0.498,6.952 -1.751,9.485c-1.261,2.548 -3.343,4.156 -6.876,3.774c-3.249,-0.351 -5.168,-2.707 -6.087,-6.088c-1.532,-5.641 -0.163,-14.332 0.113,-17.489c0.032,-0.373 0.5,-1.842 0.884,-3.401c0.167,-0.676 0.331,-1.374 0.377,-1.954c-4.423,1.361 -7.911,3.952 -10.754,7.204c-3.098,3.542 -5.44,7.858 -7.384,12.27c-0.572,1.297 -1.095,2.623 -1.594,3.962c-0.762,2.041 -1.47,4.109 -2.212,6.138c-0.108,0.297 -0.548,2.705 -1.269,3.75c-0.61,0.883 -1.415,1.184 -2.215,0.999c-1.003,-0.232 -1.885,-0.802 -2.654,-1.586c-1.315,-1.338 -2.281,-3.371 -3.226,-4.593c-1.258,-1.63 -2.313,-3.345 -3.269,-5.106c-2.14,-3.946 -3.769,-8.131 -6.225,-12.048c-0.485,-0.773 -1.096,-2.081 -1.827,-3.177c-0.201,-0.302 -0.404,-0.593 -0.619,-0.832c-0.034,0.144 -0.064,0.29 -0.08,0.414c-0.113,0.898 -0.094,1.771 -0.095,1.784c-0.265,2.665 -0.003,5.894 -0.508,8.823c-0.38,2.207 -1.176,4.251 -2.787,5.857c-2.404,2.395 -5.736,3.024 -9.135,2.49c-3.13,-0.492 -6.299,-1.975 -8.732,-3.803c-0.126,0.034 -0.25,0.066 -0.371,0.096c-7.101,1.759 -14.305,2.671 -21.152,1.932c-7.032,-0.76 -13.693,-3.252 -19.495,-8.352c-0.999,-0.877 -1.71,-1.895 -2.172,-3.021Zm44.057,7.119c2.667,-0.917 6.064,-2.578 8.403,-4.815c1.808,-1.729 2.99,-3.808 2.406,-6.188c-0.765,-3.112 -5.217,-6.924 -9.557,-8.379c-2.843,-0.953 -5.694,-0.913 -7.265,1.475c-0.444,0.674 -0.524,1.93 -0.514,3.276c0.016,2.146 0.39,4.519 0.708,5.619c0.342,1.182 0.895,2.379 1.535,3.525c0.663,1.188 1.424,2.32 2.16,3.323c0.544,0.741 1.27,1.476 2.124,2.164Zm-19.953,-46.597c-2.553,2.431 -7.444,7.775 -8.904,9.658c-0.521,0.675 -8.615,9.724 -12.381,18.521c-1.017,2.377 -1.737,4.736 -1.859,6.881c4.664,-5.307 9.538,-10.006 13.646,-15.561c2.128,-2.879 4.046,-5.99 5.616,-9.543c0.957,-2.164 2.224,-4.562 3.09,-7.014c0.345,-0.977 0.626,-1.962 0.792,-2.942Z" style="stroke:var(--logo-writing-fill-color, #000);stroke-width:3px;"/><path d="M132.419,22.823c1.039,0 1.794,-3.099 2.257,-4.079c1.237,-2.621 2.726,-4.832 4.014,-7.304c0.487,-0.935 3.51,-4.634 3.51,-3.102" style="fill:none;stroke:var(--logo-writing-fill-color, #000);stroke-width:5px;stroke-linecap:round;stroke-miterlimit:1.5;"/><g><path d="M127.285,96.614c3.008,-0 5.028,-0.802 6.941,-1.851l-0,-10.118l-7.157,-0l0.324,2.221l4.18,-0l-0,6.478c-1.234,0.663 -2.576,1.018 -4.041,1.018c-3.702,-0 -5.646,-2.561 -5.646,-8.73c0,-6.555 2.962,-8.715 6.031,-8.715c1.743,0 3.147,0.555 4.442,1.774l1.62,-1.681c-1.666,-1.527 -3.301,-2.329 -6.077,-2.329c-4.566,-0 -8.884,3.64 -8.884,10.951c-0,7.342 3.239,10.982 8.267,10.982Z" style="fill-rule:nonzero;"/><path d="M151.454,75.02l-12.154,0l0,2.144l4.72,-0l0,16.951l-4.72,0l0,2.144l12.154,-0l0,-2.144l-4.719,0l-0,-16.951l4.719,-0l0,-2.144Z" style="fill-rule:nonzero;"/><path d="M170.997,75.02l-3.764,0l-3.285,14.545l-3.44,-14.545l-3.732,0l-1.203,21.239l2.514,0l0.571,-11.121c0.123,-2.653 0.077,-6.478 0.03,-7.666l3.841,14.977l2.684,0l3.578,-14.977c-0.015,1.219 0,4.736 0.17,7.697l0.663,11.09l2.576,-0l-1.203,-21.239Z" style="fill-rule:nonzero;"/><path d="M189.783,90.197c0,-3.593 -2.529,-4.781 -4.874,-5.182c2.036,-0.463 3.949,-1.913 3.949,-4.643c-0,-4.164 -3.794,-5.352 -7.512,-5.352l-5.228,0l-0,21.239l5.707,0c3.902,0 7.958,-1.434 7.958,-6.062Zm-3.671,-9.686c0,2.499 -1.388,3.548 -3.902,3.548l-3.424,-0l-0,-6.88l3.162,0c2.56,0 4.164,0.926 4.164,3.332Zm0.849,9.779c-0,3.146 -2.591,3.763 -4.674,3.763l-3.501,0l-0,-7.789l3.625,0c2.468,0 4.55,0.818 4.55,4.026Z" style="fill-rule:nonzero;"/><path d="M198.205,77.21l9.069,0l0.309,-2.19l-12.062,0l0,21.239l12.339,-0l0,-2.144l-9.655,0l-0,-7.542l7.866,-0l0,-2.206l-7.866,0l-0,-7.157Z" style="fill-rule:nonzero;"/><path d="M214.339,96.259l12.061,0l0.309,-2.391l-9.687,0l0,-18.848l-2.683,0l-0,21.239Z" style="fill-rule:nonzero;"/></g></svg>
      </a>
    </div>
    <nav class="site-nav" aria-label="Main">
      <a class="" title="Return to home page" href="/">home</a>
      <a class="active" title="View all blog posts" href="/blog">blog</a>
      <a class="" title="Learn more about me" href="/about">about</a>
      <a href="/feed.xml" title="Subscribe via RSS/Atom">RSS</a>
    </nav>
  </header>
  <div class="header-wave">
    <svg width="100%" height="100%" viewBox="0 0 1440 120"><path d="M-7.397,22.752c85.366,24.066 343.52,34.381 501.939,34.72c151.87,0.324 301.032,-44.228 452.753,-50.937c192.025,-8.491 332.048,39.858 493.378,58.105l0.992,-68.444l-1445.91,1.218c0,0 -25.068,19.159 -3.148,25.338Z" style="fill:var(--color-header-wave);"/></svg>
  </div>

  <main class="content">
    
<article class="post" itemscope itemtype="https://schema.org/Article" >
  
  

<header class="post-header">


  <div class="break-full-width">
    <hgroup>
      <h1 class="mb0">CSS Custom Properties and a new look</h1>
      <p class="post-heading__subtitle h2  mb2 mt0"></p>
    </hgroup>
  </div>

  
  <div class="post-header__inner">
    <p>Written by <a href="/about"><i><b>Kevin Gimbel</b></i></a> on <span itemprop="datePublished">26.11.2017</span>, üçøüçø  10 min. read</p>
  </div>
  
</header>

  <div itemtype="articleBody" class="post-body stack">
    <p>You may have noticed that some things changed on this website. I completly re-wrote the Front-End and created a new theme with a focus on accessibility and well-structured content. On the web, Accessibility is enabled by default; All you need is a good HTML structure and your website is almost ready to go! A second important part of accessibility is color and contrast as well as font sizing. I decided to let users choose their own color scheme, font-size, and dark or light mode - all done with CSS Custom Properties (<abbr title="Also known as">aka</abbr> CSS variables).</p>
<p>CSS variables are a <a href="https://www.w3.org/TR/css-variables-1/" title="Read the CSS variable specs">native CSS feature</a> which enables us as developers to re-use colors, font-sizes, and other properties throught our stylesheets. You may think <em>&quot;But wait! Sass, Less, and Stylus had variables for years!&quot;</em> and you're right - the pre processors, which generate a CSS file, have had variables for years. What they did not have, however, is the abbility to modify and change these variables on the fly after the CSS had been generated. With CSS Custom Properties and some JavaScript we can modify the variables at runtime and the browser will re-render all pieces of the page which are using the variable - and that's exactly what I am doing with the settings on this website to change the accent colors and font sizing.</p>
<p>Below I will explain step by step how CSS variables look, work, and how we can use them to alter the look of a website - even persistent without any backend code!</p>
<h2>CSS variables</h2>
<h3>Browser Support</h3>
<p>Let's jump directly into browser support, which is looking pretty good in my opinion!</p>
<p class="ciu_embed" data-feature="css-variables" data-periods="future_1,current,past_1" data-accessible-colours="true">
      <picture>
        <source type="image/webp" srcset="https://caniuse.bitsofco.de/image/css-variables.webp">
        <source type="image/png" srcset="https://caniuse.bitsofco.de/image/css-variables.png">
        <img src="https://caniuse.bitsofco.de/image/css-variables.jpg" alt="Data on support for the css-variables feature across the major browsers from caniuse.com">
      </picture>
    </p>
<p><code>77.90%</code> (as of November 26. 2017) is not perfect but certainly good enough for me and my private website. I'd probably not rely on CSS Custom Properties in client projects yet tho.</p>
<h3>Syntax</h3>
<p>A CSS variable is a word preceded by two dashes (<code>--</code>), which looks like the following examples.</p>
<pre class="language-css"><code class="language-css"><span class="token property">--color</span><span class="token punctuation">:</span> #ddd<span class="token punctuation">;</span><br><span class="token property">--base-font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span><br><span class="token property">--breakpoint-large</span><span class="token punctuation">:</span> 1200px<span class="token punctuation">;</span></code></pre>
<p>Just like any CSS property they &quot;cascade down&quot;. A variable defined at the top of the document on the <code>:root</code> or <code>html</code> selector will be defined everywhere in the document. To use a CSS variable we need to get it somehow. It's not enough to reference it, for example this does not work.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">// Does not work!<br>.my-selector</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> --color<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>With CSS variables we need to retrieve the value by calling a <code>var</code> function. This function also takes a fallback parameter in case the variable is not set.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">// This does work<br>.my-selector</span> <span class="token punctuation">{</span><br>  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--color<span class="token punctuation">,</span> #333<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<p><code>.my-selector</code> will have a color value equal to whatever is stored inside the <code>--color</code> variable or <code>#333</code> if it is not set.</p>
<p>A variable can later be changed to be &quot;locally scoped&quot;. For this example we define a custom property named <code>--color</code> and set its value to <code>red</code>. We say all h1 elements should use the <code>--color</code> variable for their font-color. Then we create a CSS class named <code>local-scope</code> and inside we change the <code>--color</code> to <code>blue</code>. A <code>h1</code> element inside the <code>local-scope</code> will use the re-defined color value.</p>
<p data-height="350" data-theme-id="dark" data-slug-hash="78d261a36ecded2b75d5260cb7056fce" data-default-tab="result" data-user="Captain Anonymous" data-embed-version="2" data-pen-title="CSS Variables - Cascading & local scope" data-preview="true" data-editable="false" class="codepen" style="height: 350px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">See the Pen <a href="https://codepen.io/Captain Anonymous/pen/78d261a36ecded2b75d5260cb7056fce/">CSS Variables - Cascading & local scope</a> on <a href="https://codepen.io">CodePen</a>.</p>
<p>We do not need to change the <code>h1</code> selector because <code>h1</code> will always have a font-color equal to <code>--color</code> - we only need to change the variable inside the local scope. The third <code>h1</code> element is outside the local scope and so it takes the  original <code>--color</code> value (red).</p>
<p>This type of inheritance is a powerful tool CSS has given us (&quot;us&quot; being developers). At runtime, when the website is loaded and all CSS is parsed and the website has been painted to the screen, we can still change these properties on-the-fly with JavaScript and the browser will simply re-render the parts that need changing. Of course, you can already change CSS on the go with JavaScript. You could select for example a bunch of elements by class name and then change their color to be <code>blue</code> instead of red. With CSS Custom Properties you don't need to do this! All we need to do is change the variable at a higher level, for example on the <code>body</code> element as the following example illustrates.</p>
<p data-height="350" data-theme-id="dark" data-slug-hash="5245628703a6a223215cf5a30cf8294d" data-default-tab="result" data-user="Captain Anonymous" data-embed-version="2" data-pen-title="CSS Variables - Changing with JS" data-preview="true" data-editable="false" class="codepen" style="height: 350px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">See the Pen <a href="https://codepen.io/Captain Anonymous/pen/5245628703a6a223215cf5a30cf8294d/">CSS Variables - Changing with JS</a> on <a href="https://codepen.io">CodePen</a>.</p>
<p>Click on the <code>Change color</code> button above and all the non-scoped <code>h1</code> elements will turn green. All we need for this to work is set an inline style on the <code>body</code> element.</p>
<pre class="language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token string">"--color: green;"</span><span class="token punctuation">;</span></code></pre>
<p>I use this technique to change the secondary and primary colors of my website from the settings menu. <a href="https://github.com/kevingimbel/kevingimbel.com/blob/9f11b96f428f01b1ae14f8673c2e4f48e8ee3b21/themes/next/static/js/a11y.settings.js#L83-L84" title="View source code on GitHub.com">These two lines</a> set the CSS variables <code>--color-accent-primary</code> and <code>--color-accent-secondary</code> which by default are dark blue and yellow.</p>
<h3>Recap</h3>
<p>So let's recap this real quick:</p>
<ul>
<li>CSS variables (also called CSS Custom Properties) are a native CSS feature</li>
<li>They cascade &quot;down&quot; in the CSS, just like any other property (<code>font-size</code>, <code>color</code>, etc.)</li>
<li>They can be locally scoped, that is changed for a certain element and it's children</li>
<li>They can be changed with JavaScript at runtime and the browser will re-render every element which uses them</li>
</ul>
<p>At this point it becomes clear why they are an advantage over pre-processor variables. We have more control of changing them and they present us with a powerful new way to implement multiple layouts for our websites.</p>
<h2>Implementing persistent settings</h2>
<p>As I mentioned before for my website (this very blog you read right now), the Settings are persistent. If you change the font size or colors and navigate to a new page you'll still have your custom styles - not my default styles. I do not use any backend software like PHP, Go, or Ruby; Instead this website is a static website, which means all HTML pages are rendered before and then deployed to <a href="https://www.netlify.com/">Netlify</a>. So there is no backend which can save your settings and then send them back to your browser once you navigate to a new site.</p>
<p>The saving part is done on the client side, inside your browser. A browser feature called <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage">Local Storage</a>. Local Storage is a text-based, key-value storage which developers can use to store (small) text based values inside the browser. This allows us to have some sort of persitent storage on the client side without the need for a backend. For my use case (storing settings) this is perfect.</p>
<p>When you open the settings menu and click &quot;Save&quot; I grab all the values with JavaScript (<a href="https://github.com/kevingimbel/kevingimbel.com/blob/9f11b96f428f01b1ae14f8673c2e4f48e8ee3b21/themes/next/static/js/a11y.settings.js#L123-L138">See the code on GitHub</a>)</p>
<pre class="language-javascript"><code class="language-javascript">settingsForm<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span>settingsForm<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> cssRule <span class="token keyword">of</span> fd<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    lsSettings<span class="token punctuation">[</span>cssRule<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> cssRule<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token function">setStylesAndCreateForgroundColors</span><span class="token punctuation">(</span>lsSettings<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token function">populateSettingsFromArray</span><span class="token punctuation">(</span>lsSettings<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'a11y_settings'</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>lsSettings<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">'page-settings--open'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'tabindex'</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>There's quite a lot going on. The important bit for now is <code>localStorage.setItem('a11y_settings', JSON.stringify(lsSettings));</code>. This line sets a new item in the local storage named <code>a11y_settings</code>, scoped to my website (kevingimbel.com). This JSON object holds all relevant information for your custom settings and looks like this:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"--body-invert"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span><br>  <span class="token property">"--color-accent-primary"</span><span class="token operator">:</span> <span class="token string">"#3e934b"</span><span class="token punctuation">,</span><br>  <span class="token property">"--color-accent-secondary"</span><span class="token operator">:</span> <span class="token string">"#70cfff"</span><br><span class="token punctuation">}</span></code></pre>
<p>The key of the JSON object is always the CSS variable name, the value is the CSS variable value. With these settings we get the following result.</p>
<figure><img src="/images/posts/2017/css-custom-properties/kevingimbel_com-with-custom-settings.png" alt="The look of kevingimbel.com with the above settings" /><figcaption>The look of kevingimbel.com with the above settings</figcaption></figure>
<p>Because we use inline styles to change the CSS variables the HTML element will have the following styles.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token style language-css"><span class="token property">--body-invert</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span> <span class="token property">--color-accent-primary</span><span class="token punctuation">:</span>#3e934b<span class="token punctuation">;</span> <span class="token property">--color-accent-secondary</span><span class="token punctuation">:</span>#70cfff<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></code></pre>
<p>Once the JSON is saved to local storage, I load in on page load and apply it immediately - which happens to be really fast so it seems the styles are not even applyed again! The piece of JavaScript to load the custom styles is placed above all other content, at the beginning of the <code>&lt;body&gt;</code>. To not impact performance too much I minified it and it looks like this.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"a11y_settings"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"a11y_settings"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> o <span class="token keyword">in</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span>a<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>o<span class="token operator">==</span><span class="token string">"--body-invert"</span><span class="token operator">&amp;&amp;</span>a<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"100"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"dark-mode"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span>a11y<span class="token punctuation">)</span><span class="token punctuation">{</span>a11y<span class="token punctuation">.</span>o<span class="token operator">=</span>a<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre>
<p>Unminified the code reads as follows</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>  <span class="token keyword">if</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"a11y_settings"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br><br>    <span class="token keyword">var</span> styles <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">"a11y_settings"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> rule <span class="token keyword">in</span> styles<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span>rule<span class="token punctuation">,</span>styles<span class="token punctuation">[</span>rule<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token comment">// Check if we "dark mode" is enabled (more below!)</span><br>      <span class="token keyword">if</span><span class="token punctuation">(</span>rule<span class="token operator">==</span><span class="token string">"--body-invert"</span> <span class="token operator">&amp;&amp;</span> styles<span class="token punctuation">[</span>rule<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"100"</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"dark-mode"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token comment">// if a11y is defined, save the rules in the object</span><br>    <span class="token keyword">if</span><span class="token punctuation">(</span>a11y<span class="token punctuation">)</span><span class="token punctuation">{</span><br>      a11y<span class="token punctuation">.</span>styles <span class="token operator">=</span> styles<br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>What happens here is the following:</p>
<ul>
<li>We check if there are custom setting (<code>if( localStorage.getItem(&quot;a11y_settings&quot;) )</code>)</li>
<li>Then we read it in, it's a JSON string so we need to parse it</li>
<li>Next we loop through all properties of the JSON, which are key-value pairs like <code>{ &quot;--color&quot;: &quot;#ddd&quot; }</code></li>
<li>Each key-value pair is set as inline style on the documentElement (the <code>html</code> element)</li>
</ul>
<p>For the <code>--body-invert</code> value we take an extra step and set a CSS class on the body. This is used for the dark mode which requires the extra class to work properly. The dark-mode is a CSS filter. What I do is invert the body with a CSS Filter so the default light theme becomes a dark theme. The CodePen below shows this in action. By adding the <code>dark-mode</code> class to the second block we invert all colors, which results in the block being dark.</p>
<p data-height="350" data-theme-id="dark" data-slug-hash="604946ab15c48299b1f7b54b7a758cfb" data-default-tab="result" data-user="Captain Anonymous" data-embed-version="2" data-pen-title="Unknown Pen" data-preview="true" data-editable="false" class="codepen" style="height: 350px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">See the Pen <a href="https://codepen.io/Captain Anonymous/pen/604946ab15c48299b1f7b54b7a758cfb/">Unknown Pen</a> on <a href="https://codepen.io">CodePen</a>.</p>
<p>That's exactly what happens when you click &quot;Dark mode&quot; in the settings menu above. So why do we need the class <code>dark-mode</code>? Because with <code>filter: invert(100%)</code> everything is inverted including images and videos - which we do not want. These elements should not be inverted so we need to apply a <code>filter: invert(100%)</code> to them when dark mode is active, which is done with the following CSS snipped.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">body.dark-mode img,<br>body.dark-mode video,<br>body.dark-mode iframe</span> <span class="token punctuation">{</span><br>  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>This basically means we apply the filter two times, which results in resetting it. The images get inverted from the first rule, then inverted again to normal color.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">// Invert everything<br>body.dark-mode</span> <span class="token punctuation">{</span><br>  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><span class="token selector">// Invert img, video, and iframe again, resulting in resetting the original invert.<br>body.dark-mode img,<br>body.dark-mode video,<br>body.dark-mode iframe</span> <span class="token punctuation">{</span><br>  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token function">invert</span><span class="token punctuation">(</span>100%<span class="token punctuation">)</span> <span class="token important">!important</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>And that's it for CSS variables and the redesign. You get to choose how my blog looks, what font-size to use and if a dark or light theme is best for you. I might add more options to the settings in the future, but for now I'm happy with the result.</p>
<p>Got any feedback? Want to tell me how much the news design sucks? Love it? Hit me up on <a href="https://twitter.com/_kevinatari" title="Find me on twitter">Twitter @kevingimbel</a></p>

  </div>

  <footer class="post-footer stack">
    <hr>
    
    <p>Find similar content under:
      
        <a href="/tags/redesign">#redesign</a>  &bull; 
      
        <a href="/tags/css">#css</a>  &bull; 
      
        <a href="/tags/personal">#personal</a>  &bull; 
      
        <a href="/tags/modernization">#modernization</a>  &bull; 
      
        <a href="/tags/accessibility">#accessibility</a> 
      
    </p>
    <div class="flex [ post__prev-next ]" style="--padding: 1rem 0;">
    <div class="flex__boxed"><b>Previous post</b><br><a class="h5" href="/blog/2017/04/2017-week-10-11-12-13/">2017, week 10, 11, 12, 13</a></div>
    <div class="flex__boxed"><b>Next post</b><br><a class="h5" href="/blog/2018/04/til-bash-select/">TIL: Bash select</a></div>
    </div>
  </footer>

<section class="author__bio pop-box" style="--color-left: orange; --color-right: purple;">
<div class="flex  [ small-flex__column-reverse ]">
  <div class="flex__boxed" style="max-width: 75%; --padding: 2em 2em 0 0;">
    <p class="h4 mt0">Hi, I'm Kevin!</p>
    <p>I'm a <b>DevOps Engineer</b> with a focus on automation and security. Before shifting into DevOps and cloud computing I worked as <i class="t-accent">Front-End Developer</i>, which is still a hobby and field of interest for me.</p>
  </div>
  <div class="flex__boxed" style="--padding: 2em 0 0 0;">
    <img src="/assets/img/kevin-avatar-w200.jpg" class="author__avatar" alt="Image of Kevin Gimbel, Author of this website"/>
  </div>
</div>
<p>I'm very passionated about a variety of games  - digital, boardgames, and pen & paper; and also interested in Sci-Fi, Cyberpunk, and dystopian books. You can find out more <a href="/about">on the about page</a>.</p>
</section>
</article>

  </main>

  <div class="footer-wave" style="--color-header-wave: var(--color-footer-wave); transform: rotate(180deg)">
    <svg width="100%" height="100%" viewBox="0 0 1440 120"><path d="M-7.397,22.752c85.366,24.066 343.52,34.381 501.939,34.72c151.87,0.324 301.032,-44.228 452.753,-50.937c192.025,-8.491 332.048,39.858 493.378,58.105l0.992,-68.444l-1445.91,1.218c0,0 -25.068,19.159 -3.148,25.338Z" style="fill:var(--color-header-wave);"/></svg>
  </div>

  <footer class="site-footer  [ small-flex__column ]">
  <div class="footer-block">
      <nav class="footer-nav" aria-label="Footer">
        <a href="/photography" title="View some of my photography">photography</a> &bullet;
        <a href="/art" title="View some of my art">art</a> &bullet;
        <a href="/about" title="Learn more about me">about</a> &bullet;
        <a href="/legal" title="Impressum, Imprint, Legal info">impressum</a> &bullet;
        <a href="/uses" title="# Tools, equipment, hardware, etc. I use and like">uses</a> &bullet;
        <a href="/feed.xml" title="Subscribe via RSS/Atom">RSS</a>
      </nav>
      <p>&copy; 2009 - 2021 Kevin Gimbel</p>
    </div>
    
    <div class="footer-block">
      <p><a href="https://twitter.com/KevinGimbel" title="Follow me on Twitter!" rel="me">Twitter</a> | <a href="https://github.com/KevinGimbel" title="See my open source code on GitHub.com" rel="me">GitHub</a> | <a href="https://www.eyeem.com/u/kevingimbel" title="View or purchase my photographs on EyeEm.com">EyeEm</a></p>
    </div>
    
    <div class="footer-block">
      <p><small>Forever work in progress</small></p>
      <small><a href="https://github.com/KevinGimbel/kevingimbel.de/blob/main/./src/_blog/2017/11/26-a-new-look.md">Edit this page on GitHub</a></small>
    </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/gh/ireade/caniuse-embed/public/caniuse-embed.min.js"></script>
  <script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>
  
  
</body>
</html>